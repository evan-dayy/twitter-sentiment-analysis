"0","## build the data frame and model  ----------"
"0","## for bing:"
"0","sentment_bing = tidy_books %>%"
"0","        inner_join(bing) %>%"
"0","        count(date, time, word, sentiment) %>%"
"0","        spread(sentiment, n, fill = 0) %>%"
"0","        select(-word) %>%"
"0","        group_by(date, time) %>%"
"0","        summarise_all(sum)"
"2","Joining, by = ""word""
"
"0","colnames(sentment_bing)[2] = 'datetime'"
"0","sentment_bing$datetime = as.POSIXct(sentment_bing$datetime)"
"0","sentment_bing$time_se = format(sentment_bing$datetime, format = '%H:%M')"
"0","full_bing = full_join(stock,sentment_bing)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_bing$time_stock = ifelse(is.na(full_bing$time_stock), "
"0","                             full_bing$time_se, full_bing$time_stock)"
"0","full_bing = full_bing[,-7]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_bing$state = ifelse((strptime(full_bing$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_bing$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_bing_close =  full_bing%>%"
"0","        filter(state == 'close')"
"0","full_bing_close = na.omit(full_bing_close)"
"0",""
"0",""
"0",""
"0","full_bing_open = full_bing %>%"
"0","        filter(state == 'open')"
"0","full_bing_open = na.omit(full_bing_open)"
"0",""
"0",""
"0","full_bing = rbind(full_bing_close,full_bing_open)"
"0",""
"0",""
"0",""
"0","md_bing = lm(log(price) ~ negative+positive, data = full_bing)"
"2","NaNs produced"
"0","summary(md_bing)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ negative + positive, data = full_bing)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-0.51978 "
"1","-0.23892 "
"1","-0.04478 "
"1"," 0.28628 "
"1"," 0.59593 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.1365357"
"1","  0.0712993"
"1","  -1.915"
"1","  0.05931"
"1"," .  "
"1","
negative   "
"1","  0.0056398"
"1","  0.0014364"
"1","   3.926"
"1","  0.00019"
"1"," ***"
"1","
positive   "
"1"," -0.0021790"
"1","  0.0009213"
"1","  -2.365"
"1","  0.02061"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.2946"
"1"," "
"1","on"
"1"," "
"1","75"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","74 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.1736"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.1515"
"1"," "
"1","
F-statistic:"
"1"," "
"1","7.877"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","75"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.0007852"
"1","
"
"1","
"
"0","md_bing_close = lm(price ~  negative+positive, data = full_bing_close)"
"0","summary(md_bing_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.58386 "
"1","-0.89985 "
"1","-0.03086 "
"1"," 0.78201 "
"1"," 1.45848 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1"," -0.0306825"
"1","  0.1754229"
"1","  -0.175"
"1","    0.862"
"1","
negative   "
"1","  0.0021425"
"1","  0.0045473"
"1","   0.471"
"1","    0.639"
"1","
positive   "
"1"," -0.0001274"
"1","  0.0022167"
"1","  -0.057"
"1","    0.954"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9738"
"1"," "
"1","on"
"1"," "
"1","77"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.005971"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.01985"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.2313"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","77"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.7941"
"1","
"
"1","
"
"0","md_bing_open = lm(price ~  negative+positive, data = full_bing_open)"
"0","summary(md_bing_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.58279 "
"1","-0.71705 "
"1"," 0.05908 "
"1"," 0.65101 "
"1"," 2.57366 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)"
"1","  0.041514"
"1","   0.249994"
"1","   0.166"
"1","  0.86859"
"1","   "
"1","
negative   "
"1"," -0.014665"
"1","   0.004728"
"1","  -3.102"
"1","  0.00279"
"1"," **"
"1","
positive   "
"1","  0.010344"
"1","   0.003088"
"1","   3.350"
"1","  0.00131"
"1"," **"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9345"
"1"," "
"1","on"
"1"," "
"1","69"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.1532"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.1286"
"1"," "
"1","
F-statistic:"
"1"," "
"1","6.241"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","69"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.003225"
"1","
"
"1","
"
"0","## for afinn"
"0","colnames(sentment_afinn)[2] = 'datetime'"
"0","sentment_afinn$datetime = as.POSIXct(sentment_afinn$datetime)"
"0","sentment_afinn$time_se = format(sentment_afinn$datetime, format = '%H:%M')"
"0","full_afinn = full_join(stock,sentment_afinn)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_afinn$time_stock = ifelse(is.na(full_afinn$time_stock), "
"0","                              full_afinn$time_se, full_afinn$time_stock)"
"0",""
"0","full_afinn = full_afinn[,-6]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_afinn$state = ifelse((strptime(full_afinn$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_afinn$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_afinn_close =  full_afinn%>%"
"0","        filter(state == 'close')"
"0","full_afinn_close = na.omit(full_afinn_close)"
"0",""
"0","full_afinn_open = full_afinn %>%"
"0","        filter(state == 'open')"
"0","full_afinn_open = na.omit(full_afinn_open)"
"0","full_afinn = rbind(full_afinn_close,full_afinn_open)"
"0",""
"0",""
"0","md_afinn = lm(log(price) ~ sentiment, data = full_afinn)"
"2","NaNs produced"
"0","summary(md_afinn)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ sentiment, data = full_afinn)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-0.5069 "
"1","-0.3059 "
"1","-0.0430 "
"1"," 0.2671 "
"1"," 0.5517 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1"," -0.05403"
"1","    0.03657"
"1","  -1.478"
"1","    0.144"
"1","
sentiment  "
"1"," -0.04576"
"1","    0.05490"
"1","  -0.834"
"1","    0.407"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.3205"
"1"," "
"1","on"
"1"," "
"1","76"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","74 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.00906"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.003979"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.6948"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","76"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.4071"
"1","
"
"1","
"
"0","md_afinn_close = lm(price ~ sentiment, data = full_afinn_close)"
"0","summary(md_afinn_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.43726 "
"1","-0.95765 "
"1","-0.08377 "
"1"," 0.82857 "
"1"," 1.55570 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1","  0.06110"
"1","    0.10848"
"1","   0.563"
"1","    0.575"
"1","
sentiment  "
"1"," -0.02427"
"1","    0.07100"
"1","  -0.342"
"1","    0.733"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9697"
"1"," "
"1","on"
"1"," "
"1","78"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.001495"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.01131"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.1168"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","78"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.7334"
"1","
"
"1","
"
"0","md_afinn_open = lm(price ~ sentiment, data = full_afinn_open)"
"0","summary(md_afinn_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.6983 "
"1","-0.9832 "
"1"," 0.1375 "
"1"," 0.7999 "
"1"," 1.5900 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1","   0.1680"
"1","     0.1142"
"1","   1.471"
"1","   0.1459"
"1","  "
"1","
sentiment  "
"1","   0.4033"
"1","     0.1626"
"1","   2.480"
"1","   0.0156"
"1"," *"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9667"
"1"," "
"1","on"
"1"," "
"1","70"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.08076"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.06762"
"1"," "
"1","
F-statistic:"
"1"," "
"1","6.149"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","70"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.01555"
"1","
"
"1","
"
