"0","## build the data frame and model  ----------"
"0","## for bing:"
"0","sentment_bing = tidy_books %>%"
"0","        inner_join(bing) %>%"
"0","        count(date, time, word, sentiment) %>%"
"0","        spread(sentiment, n, fill = 0) %>%"
"0","        select(-word) %>%"
"0","        group_by(date, time) %>%"
"0","        summarise_all(sum)"
"2","Joining, by = ""word""
"
"0","colnames(sentment_bing)[2] = 'datetime'"
"0","sentment_bing$datetime = as.POSIXct(sentment_bing$datetime)"
"0","sentment_bing$time_se = format(sentment_bing$datetime, format = '%H:%M')"
"0","full_bing = full_join(stock,sentment_bing)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_bing$time_stock = ifelse(is.na(full_bing$time_stock), "
"0","                             full_bing$time_se, full_bing$time_stock)"
"0","full_bing = full_bing[,-7]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_bing$state = ifelse((strptime(full_bing$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_bing$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_bing_close =  full_bing%>%"
"0","        filter(state == 'close')"
"0","full_bing_close = na.omit(full_bing_close)"
"0",""
"0",""
"0",""
"0","full_bing_open = full_bing %>%"
"0","        filter(state == 'open')"
"0","full_bing_open = na.omit(full_bing_open)"
"0",""
"0",""
"0","full_bing = rbind(full_bing_close,full_bing_open)"
"0",""
"0",""
"0",""
"0","md_bing = lm(log(price) ~ negative+positive, data = full_bing)"
"2","NaNs produced"
"0","summary(md_bing)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ negative + positive, data = full_bing)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.83285 "
"1","-0.46605 "
"1"," 0.01126 "
"1"," 0.63378 "
"1"," 1.04983 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.583516"
"1","   0.152057"
"1","  -3.837"
"1"," 0.000257"
"1"," ***"
"1","
negative   "
"1","  0.014161"
"1","   0.004165"
"1","   3.400"
"1"," 0.001082"
"1"," ** "
"1","
positive   "
"1"," -0.006533"
"1","   0.003408"
"1","  -1.917"
"1"," 0.059051"
"1"," .  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.7039"
"1"," "
"1","on"
"1"," "
"1","75"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","81 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.1607"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.1383"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 7.18"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","75"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.001402"
"1","
"
"1","
"
"0","md_bing_close = lm(price ~  negative+positive, data = full_bing_close)"
"0","summary(md_bing_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.4497 "
"1","-0.7788 "
"1","-0.1623 "
"1"," 0.6357 "
"1"," 1.8860 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1"," -0.297213"
"1","   0.174894"
"1","  -1.699"
"1","   0.0931"
"1"," ."
"1","
negative   "
"1","  0.001741"
"1","   0.006787"
"1","   0.257"
"1","   0.7982"
"1","  "
"1","
positive   "
"1","  0.004999"
"1","   0.005940"
"1","   0.842"
"1","   0.4025"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9149"
"1"," "
"1","on"
"1"," "
"1","80"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.05206"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.02836"
"1"," "
"1","
F-statistic:"
"1"," "
"1","2.197"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","80"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.1178"
"1","
"
"1","
"
"0","md_bing_open = lm(price ~  negative+positive, data = full_bing_open)"
"0","summary(md_bing_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.33428 "
"1","-0.95712 "
"1","-0.05755 "
"1"," 0.63993 "
"1"," 2.18249 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1"," -0.165283"
"1","   0.254024"
"1","  -0.651"
"1","   0.5173"
"1","  "
"1","
negative   "
"1"," -0.004004"
"1","   0.005035"
"1","  -0.795"
"1","   0.4291"
"1","  "
"1","
positive   "
"1","  0.006616"
"1","   0.003828"
"1","   1.728"
"1","   0.0882"
"1"," ."
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.023"
"1"," "
"1","on"
"1"," "
"1","73"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.0446"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.01843"
"1"," "
"1","
F-statistic:"
"1"," "
"1","1.704"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","73"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.1891"
"1","
"
"1","
"
"0","## for afinn"
"0","colnames(sentment_afinn)[2] = 'datetime'"
"0","sentment_afinn$datetime = as.POSIXct(sentment_afinn$datetime)"
"0","sentment_afinn$time_se = format(sentment_afinn$datetime, format = '%H:%M')"
"0","full_afinn = full_join(stock,sentment_afinn)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_afinn$time_stock = ifelse(is.na(full_afinn$time_stock), "
"0","                              full_afinn$time_se, full_afinn$time_stock)"
"0",""
"0","full_afinn = full_afinn[,-6]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_afinn$state = ifelse((strptime(full_afinn$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_afinn$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_afinn_close =  full_afinn%>%"
"0","        filter(state == 'close')"
"0","full_afinn_close = na.omit(full_afinn_close)"
"0",""
"0","full_afinn_open = full_afinn %>%"
"0","        filter(state == 'open')"
"0","full_afinn_open = na.omit(full_afinn_open)"
"0","full_afinn = rbind(full_afinn_close,full_afinn_open)"
"0",""
"0",""
"0","md_afinn = lm(log(price) ~ sentiment, data = full_afinn)"
"2","NaNs produced"
"0","summary(md_afinn)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ sentiment, data = full_afinn)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-2.17391 "
"1","-0.55763 "
"1"," 0.05258 "
"1"," 0.67679 "
"1"," 1.11907 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.335215"
"1","   0.089361"
"1","  -3.751"
"1"," 0.000342"
"1"," ***"
"1","
sentiment  "
"1","  0.009936"
"1","   0.076035"
"1","   0.131"
"1"," 0.896378"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.7632"
"1"," "
"1","on"
"1"," "
"1","76"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","81 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.0002246"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.01293"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.01708"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","76"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.8964"
"1","
"
"1","
"
"0","md_afinn_close = lm(price ~ sentiment, data = full_afinn_close)"
"0","summary(md_afinn_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.3393 "
"1","-0.8607 "
"1","-0.2293 "
"1"," 0.6310 "
"1"," 2.0392 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1","  0.03297"
"1","    0.10242"
"1","   0.322"
"1","   0.7484"
"1","  "
"1","
sentiment  "
"1","  0.19501"
"1","    0.11144"
"1","   1.750"
"1","   0.0839"
"1"," ."
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9167"
"1"," "
"1","on"
"1"," "
"1","81"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.03643"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.02453"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.062"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","81"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.08393"
"1","
"
"1","
"
"0","md_afinn_open = lm(price ~ sentiment, data = full_afinn_open)"
"0","summary(md_afinn_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.3521 "
"1","-0.9056 "
"1","-0.1274 "
"1"," 0.6688 "
"1"," 2.2356 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1","  0.04336"
"1","    0.12282"
"1","   0.353"
"1","    0.725"
"1","  "
"1","
sentiment  "
"1","  0.17603"
"1","    0.09217"
"1","   1.910"
"1","    0.060"
"1"," ."
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.015"
"1"," "
"1","on"
"1"," "
"1","74"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.04697"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.03409"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.647"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","74"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.06004"
"1","
"
"1","
"
