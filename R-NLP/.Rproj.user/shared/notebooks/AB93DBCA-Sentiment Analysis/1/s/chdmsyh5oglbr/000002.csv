"0","## build the data frame and model  ----------"
"0","## for bing:"
"0","sentment_bing = tidy_books %>%"
"0","        inner_join(bing) %>%"
"0","        count(date, time, word, sentiment) %>%"
"0","        spread(sentiment, n, fill = 0) %>%"
"0","        select(-word) %>%"
"0","        group_by(date, time) %>%"
"0","        summarise_all(sum)"
"2","Joining, by = ""word""
"
"0","colnames(sentment_bing)[2] = 'datetime'"
"0","sentment_bing$datetime = as.POSIXct(sentment_bing$datetime)"
"0","sentment_bing$time_se = format(sentment_bing$datetime, format = '%H:%M')"
"0","full_bing = full_join(stock,sentment_bing)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_bing$time_stock = ifelse(is.na(full_bing$time_stock), "
"0","                             full_bing$time_se, full_bing$time_stock)"
"0","full_bing = full_bing[,-7]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_bing$state = ifelse((strptime(full_bing$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_bing$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_bing_close =  full_bing%>%"
"0","        filter(state == 'close')"
"0","full_bing_close = na.omit(full_bing_close)"
"0",""
"0",""
"0",""
"0","full_bing_open = full_bing %>%"
"0","        filter(state == 'open')"
"0","full_bing_open = na.omit(full_bing_open)"
"0",""
"0",""
"0","full_bing = rbind(full_bing_close,full_bing_open)"
"0",""
"0",""
"0",""
"0","md_bing = lm(log(price) ~ negative+positive, data = full_bing)"
"2","NaNs produced"
"0","summary(md_bing)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ negative + positive, data = full_bing)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.2983 "
"1","-0.2667 "
"1"," 0.1457 "
"1"," 0.4146 "
"1"," 0.6374 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.430335"
"1","   0.110507"
"1","  -3.894"
"1"," 0.000207"
"1"," ***"
"1","
negative   "
"1","  0.008062"
"1","   0.007335"
"1","   1.099"
"1"," 0.275065"
"1","    "
"1","
positive   "
"1","  0.001750"
"1","   0.008279"
"1","   0.211"
"1"," 0.833160"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.6154"
"1"," "
"1","on"
"1"," "
"1","78"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","75 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.06192"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.03786"
"1"," "
"1","
F-statistic:"
"1"," "
"1","2.574"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","78"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.08268"
"1","
"
"1","
"
"0","md_bing_close = lm(price ~  negative+positive, data = full_bing_close)"
"0","summary(md_bing_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.6205 "
"1","-0.8936 "
"1"," 0.1495 "
"1"," 0.9099 "
"1"," 1.4643 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1"," -0.284881"
"1","   0.172527"
"1","  -1.651"
"1","    0.104"
"1","
negative   "
"1","  0.011265"
"1","   0.013707"
"1","   0.822"
"1","    0.414"
"1","
positive   "
"1","  0.006424"
"1","   0.017685"
"1","   0.363"
"1","    0.718"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9756"
"1"," "
"1","on"
"1"," "
"1","65"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.06851"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.03985"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 2.39"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","65"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.09959"
"1","
"
"1","
"
"0","md_bing_open = lm(price ~  negative+positive, data = full_bing_open)"
"0","summary(md_bing_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.7334 "
"1","-0.9110 "
"1"," 0.2088 "
"1"," 0.8445 "
"1"," 1.4978 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1"," -0.361961"
"1","   0.177146"
"1","  -2.043"
"1","   0.0441"
"1"," *"
"1","
negative   "
"1","  0.009157"
"1","   0.014982"
"1","   0.611"
"1","   0.5427"
"1","  "
"1","
positive   "
"1","  0.014101"
"1","   0.012778"
"1","   1.103"
"1","   0.2729"
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9792"
"1"," "
"1","on"
"1"," "
"1","85"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.08223"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.06063"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.808"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","85"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.02607"
"1","
"
"1","
"
"0","## for afinn"
"0","colnames(sentment_afinn)[2] = 'datetime'"
"0","sentment_afinn$datetime = as.POSIXct(sentment_afinn$datetime)"
"0","sentment_afinn$time_se = format(sentment_afinn$datetime, format = '%H:%M')"
"0","full_afinn = full_join(stock,sentment_afinn)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_afinn$time_stock = ifelse(is.na(full_afinn$time_stock), "
"0","                              full_afinn$time_se, full_afinn$time_stock)"
"0",""
"0","full_afinn = full_afinn[,-6]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_afinn$state = ifelse((strptime(full_afinn$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_afinn$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_afinn_close =  full_afinn%>%"
"0","        filter(state == 'close')"
"0","full_afinn_close = na.omit(full_afinn_close)"
"0",""
"0","full_afinn_open = full_afinn %>%"
"0","        filter(state == 'open')"
"0","full_afinn_open = na.omit(full_afinn_open)"
"0","full_afinn = rbind(full_afinn_close,full_afinn_open)"
"0",""
"0",""
"0","md_afinn = lm(log(price) ~ sentiment, data = full_afinn)"
"2","NaNs produced"
"0","summary(md_afinn)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ sentiment, data = full_afinn)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-3.3577 "
"1","-0.2985 "
"1"," 0.1297 "
"1"," 0.4339 "
"1"," 0.6369 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," -0.26737"
"1","    0.07047"
"1","  -3.794"
"1"," 0.000289"
"1"," ***"
"1","
sentiment  "
"1","  0.06243"
"1","    0.05918"
"1","   1.055"
"1"," 0.294669"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.627"
"1"," "
"1","on"
"1"," "
"1","79"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","73 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.01389"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.001409"
"1"," "
"1","
F-statistic:"
"1"," "
"1","1.113"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","79"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.2947"
"1","
"
"1","
"
"0","md_afinn_close = lm(price ~ sentiment, data = full_afinn_close)"
"0","summary(md_afinn_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.7373 "
"1","-0.9152 "
"1"," 0.1103 "
"1"," 0.8364 "
"1"," 1.4868 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1","  0.01359"
"1","    0.12103"
"1","   0.112"
"1","    0.911"
"1","
sentiment  "
"1","  0.17169"
"1","    0.11370"
"1","   1.510"
"1","    0.136"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9763"
"1"," "
"1","on"
"1"," "
"1","64"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.0344"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.01931"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 2.28"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","64"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.136"
"1","
"
"1","
"
"0","md_afinn_open = lm(price ~ sentiment, data = full_afinn_open)"
"0","summary(md_afinn_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.7113 "
"1","-0.9529 "
"1"," 0.1885 "
"1"," 0.8690 "
"1"," 1.5031 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1"," 0.008886"
"1","   0.106711"
"1","   0.083"
"1","   0.9338"
"1","  "
"1","
sentiment  "
"1"," 0.176051"
"1","   0.096040"
"1","   1.833"
"1","   0.0702"
"1"," ."
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9969"
"1"," "
"1","on"
"1"," "
"1","86"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.0376"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.02641"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 3.36"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","86"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.07025"
"1","
"
"1","
"
