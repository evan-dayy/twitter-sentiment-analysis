"0",""
"0","full_nrc = rbind(full_nrc_close,full_nrc_open)"
"0",""
"0","full_nrc$anger  = normalize(full_nrc$anger )"
"0","full_nrc$anticipation  = normalize(full_nrc$anticipation )"
"0","full_nrc$disgust  = normalize(full_nrc$disgust )"
"0","full_nrc$fear  = normalize(full_nrc$fear )"
"0","full_nrc$joy  = normalize(full_nrc$joy )"
"0","full_nrc$negative  = normalize(full_nrc$negative )"
"0","full_nrc$positive  = normalize(full_nrc$positive )"
"0","full_nrc$sadness  = normalize(full_nrc$sadness )"
"0","full_nrc$surprise  = normalize(full_nrc$surprise )"
"0","full_nrc$trust  = normalize(full_nrc$trust )"
"0","## build the data frame and model  ----------"
"0","## for bing:"
"0","sentment_bing = tidy_books %>%"
"0","        inner_join(bing) %>%"
"0","        count(date, time, word, sentiment) %>%"
"0","        spread(sentiment, n, fill = 0) %>%"
"0","        select(-word) %>%"
"0","        group_by(date, time) %>%"
"0","        summarise_all(sum)"
"2","Joining, by = ""word""
"
"0","colnames(sentment_bing)[2] = 'datetime'"
"0","sentment_bing$datetime = as.POSIXct(sentment_bing$datetime)"
"0","sentment_bing$time_se = format(sentment_bing$datetime, format = '%H:%M')"
"0","full_bing = full_join(stock,sentment_bing)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_bing$time_stock = ifelse(is.na(full_bing$time_stock), "
"0","                             full_bing$time_se, full_bing$time_stock)"
"0","full_bing = full_bing[,-7]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_bing$state = ifelse((strptime(full_bing$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_bing$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_bing_close =  full_bing%>%"
"0","        filter(state == 'close')"
"0","full_bing_close = na.omit(full_bing_close)"
"0",""
"0",""
"0",""
"0","full_bing_open = full_bing %>%"
"0","        filter(state == 'open')"
"0","full_bing_open = na.omit(full_bing_open)"
"0",""
"0",""
"0","full_bing = rbind(full_bing_close,full_bing_open)"
"0","full_bing$negative = normalize(full_bing$negative)"
"0","full_bing$positive = normalize(full_bing$positive)"
"0",""
"0","## for afinn"
"0","colnames(sentment_afinn)[2] = 'datetime'"
"0","sentment_afinn$datetime = as.POSIXct(sentment_afinn$datetime)"
"0","sentment_afinn$time_se = format(sentment_afinn$datetime, format = '%H:%M')"
"0","full_afinn = full_join(stock,sentment_afinn)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_afinn$time_stock = ifelse(is.na(full_afinn$time_stock), "
"0","                              full_afinn$time_se, full_afinn$time_stock)"
"0",""
"0","full_afinn = full_afinn[,-6]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_afinn$state = ifelse((strptime(full_afinn$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_afinn$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_afinn_close =  full_afinn%>%"
"0","        filter(state == 'close')"
"0","full_afinn_close = na.omit(full_afinn_close)"
"0",""
"0","full_afinn_open = full_afinn %>%"
"0","        filter(state == 'open')"
"0","full_afinn_open = na.omit(full_afinn_open)"
"0","full_afinn = rbind(full_afinn_close,full_afinn_open)"
