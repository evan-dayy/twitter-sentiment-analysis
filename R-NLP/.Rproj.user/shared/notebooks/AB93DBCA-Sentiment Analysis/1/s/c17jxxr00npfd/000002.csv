"0","## build the data frame and model  ----------"
"0","## for bing:"
"0","sentment_bing = tidy_books %>%"
"0","        inner_join(bing) %>%"
"0","        count(date, time, word, sentiment) %>%"
"0","        spread(sentiment, n, fill = 0) %>%"
"0","        select(-word) %>%"
"0","        group_by(date, time) %>%"
"0","        summarise_all(sum)"
"2","Joining, by = ""word""
"
"0","colnames(sentment_bing)[2] = 'datetime'"
"0","sentment_bing$datetime = as.POSIXct(sentment_bing$datetime)"
"0","sentment_bing$time_se = format(sentment_bing$datetime, format = '%H:%M')"
"0","full_bing = full_join(stock,sentment_bing)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_bing$time_stock = ifelse(is.na(full_bing$time_stock), "
"0","                             full_bing$time_se, full_bing$time_stock)"
"0","full_bing = full_bing[,-7]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_bing$state = ifelse((strptime(full_bing$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_bing$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_bing_close =  full_bing%>%"
"0","        filter(state == 'close')"
"0","full_bing_close = na.omit(full_bing_close)"
"0",""
"0",""
"0",""
"0","full_bing_open = full_bing %>%"
"0","        filter(state == 'open')"
"0","full_bing_open = na.omit(full_bing_open)"
"0",""
"0",""
"0","full_bing = rbind(full_bing_close,full_bing_open)"
"0",""
"0",""
"0",""
"0","md_bing = lm(log(price) ~ negative+positive, data = full_bing)"
"2","NaNs produced"
"0","summary(md_bing)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ negative + positive, data = full_bing)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-2.62678 "
"1","-0.17104 "
"1"," 0.07464 "
"1"," 0.23398 "
"1"," 0.39376 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1","  0.007818"
"1","   0.076561"
"1","   0.102"
"1","    0.919"
"1","
negative   "
"1"," -0.002780"
"1","   0.006310"
"1","  -0.441"
"1","    0.661"
"1","
positive   "
"1","  0.001294"
"1","   0.004455"
"1","   0.291"
"1","    0.772"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4044"
"1"," "
"1","on"
"1"," "
"1","63"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","76 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.003161"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.02848"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.09989"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","63"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.9051"
"1","
"
"1","
"
"0","md_bing_close = lm(price ~  negative+positive, data = full_bing_close)"
"0","summary(md_bing_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.3344 "
"1","-0.8276 "
"1","-0.1432 "
"1"," 0.9194 "
"1"," 1.5819 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","   "
"1","
(Intercept)"
"1","  0.09806"
"1","    0.22708"
"1","   0.432"
"1","  0.66760"
"1","   "
"1","
negative   "
"1"," -0.03840"
"1","    0.01422"
"1","  -2.701"
"1","  0.00921"
"1"," **"
"1","
positive   "
"1","  0.03223"
"1","    0.01781"
"1","   1.810"
"1","  0.07590"
"1"," . "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9419"
"1"," "
"1","on"
"1"," "
"1","54"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.1191"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.08642"
"1"," "
"1","
F-statistic:"
"1"," "
"1","3.649"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","54"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.03263"
"1","
"
"1","
"
"0","md_bing_open = lm(price ~  negative+positive, data = full_bing_open)"
"0","summary(md_bing_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ negative + positive, data = full_bing_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.3958 "
"1","-1.0385 "
"1","-0.1054 "
"1"," 0.9578 "
"1"," 1.4124 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1","  0.076487"
"1","   0.186697"
"1","   0.410"
"1","    0.683"
"1","
negative   "
"1"," -0.012294"
"1","   0.013003"
"1","  -0.945"
"1","    0.347"
"1","
positive   "
"1","  0.008240"
"1","   0.009935"
"1","   0.829"
"1","    0.409"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.01"
"1"," "
"1","on"
"1"," "
"1","82"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.01118"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.01294"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.4636"
"1"," "
"1","on"
"1"," "
"1","2"
"1"," "
"1","and"
"1"," "
"1","82"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.6306"
"1","
"
"1","
"
"0","## for afinn"
"0","colnames(sentment_afinn)[2] = 'datetime'"
"0","sentment_afinn$datetime = as.POSIXct(sentment_afinn$datetime)"
"0","sentment_afinn$time_se = format(sentment_afinn$datetime, format = '%H:%M')"
"0","full_afinn = full_join(stock,sentment_afinn)"
"2","Joining, by = c(""datetime"", ""date"")
"
"0","full_afinn$time_stock = ifelse(is.na(full_afinn$time_stock), "
"0","                              full_afinn$time_se, full_afinn$time_stock)"
"0",""
"0","full_afinn = full_afinn[,-6]"
"0","opentime = ""09:00"""
"0","closetime = ""16:00"""
"0","full_afinn$state = ifelse((strptime(full_afinn$time_stock, format = '%H:%M') >= strptime(opentime, format = '%H:%M')) & (strptime(full_afinn$time_stock, format = '%H:%M') <= strptime(closetime, format = '%H:%M')), 'open', 'close' )"
"0",""
"0","full_afinn_close =  full_afinn%>%"
"0","        filter(state == 'close')"
"0","full_afinn_close = na.omit(full_afinn_close)"
"0",""
"0","full_afinn_open = full_afinn %>%"
"0","        filter(state == 'open')"
"0","full_afinn_open = na.omit(full_afinn_open)"
"0","full_afinn = rbind(full_afinn_close,full_afinn_open)"
"0",""
"0",""
"0","md_afinn = lm(log(price) ~ sentiment, data = full_afinn)"
"2","NaNs produced"
"0","summary(md_afinn)"
"1","
Call:
"
"1",""
"1","lm(formula = log(price) ~ sentiment, data = full_afinn)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-2.62394 "
"1","-0.17043 "
"1"," 0.07208 "
"1"," 0.23020 "
"1"," 0.40258 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1"," -0.003195"
"1","   0.050368"
"1","  -0.063"
"1","    0.950"
"1","
sentiment  "
"1"," -0.018030"
"1","   0.047180"
"1","  -0.382"
"1","    0.704"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4014"
"1"," "
"1","on"
"1"," "
"1","64"
"1"," "
"1","degrees of freedom"
"1","
"
"1","  ("
"1",""
"1","76 observations deleted due to missingness"
"1",""
"1",")
"
"1","Multiple R-squared: "
"1"," "
"1","0.002277"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.01331"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.146"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","64"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.7036"
"1","
"
"1","
"
"0","md_afinn_close = lm(price ~ sentiment, data = full_afinn_close)"
"0","summary(md_afinn_close)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_close)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.4335 "
"1","-0.8305 "
"1","-0.1529 "
"1"," 0.8843 "
"1"," 1.5283 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","  "
"1","
(Intercept)"
"1","  0.08887"
"1","    0.12815"
"1","   0.693"
"1","   0.4909"
"1","  "
"1","
sentiment  "
"1","  0.34655"
"1","    0.15567"
"1","   2.226"
"1","   0.0301"
"1"," *"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.9524"
"1"," "
"1","on"
"1"," "
"1","55"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.08266"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.06598"
"1"," "
"1","
F-statistic:"
"1"," "
"1","4.956"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","55"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.03012"
"1","
"
"1","
"
"0","md_afinn_open = lm(price ~ sentiment, data = full_afinn_open)"
"0","summary(md_afinn_open)"
"1","
Call:
"
"1",""
"1","lm(formula = price ~ sentiment, data = full_afinn_open)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-1.4316 "
"1","-0.9994 "
"1","-0.1133 "
"1"," 0.9360 "
"1"," 1.4888 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","
(Intercept)"
"1","  0.02772"
"1","    0.10914"
"1","   0.254"
"1","    0.800"
"1","
sentiment  "
"1","  0.13069"
"1","    0.10481"
"1","   1.247"
"1","    0.216"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1"
"1"," "
"1","on"
"1"," "
"1","83"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.01839"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.006562"
"1"," "
"1","
F-statistic:"
"1"," "
"1","1.555"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","83"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.2159"
"1","
"
"1","
"
